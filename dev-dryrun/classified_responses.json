[
  {
    "path": "src/middleware/apiTimeout.js",
    "line": 66,
    "status": 504,
    "classification": "error",
    "snippet": "res.status(504).json({ status: 'error', message: 'Request timed out', timeoutMs, requestId })"
  },
  {
    "path": "src/middleware/validation.js",
    "line": 13,
    "status": 400,
    "classification": "error",
    "snippet": "res.status(400).json({ success: false, message: 'Invalid request payload' })"
  },
  {
    "path": "src/middleware/maintenanceMode.js",
    "line": 13,
    "status": 503,
    "classification": "error",
    "snippet": "res.status(503).json({ status: 'error', message: 'System is in maintenance mode', reason: state.reason || null, code: 'MAINTENANCE_MODE' })"
  },
  {
    "path": "src/middleware/jwtTenantContext.js",
    "line": 7,
    "status": 401,
    "classification": "error",
    "snippet": "res.status(401).json({ success: false, message: 'Missing token' })"
  },
  {
    "path": "src/middleware/jwtTenantContext.js",
    "line": 16,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ success: false, message: 'Company context required' })"
  },
  {
    "path": "src/middleware/jwtTenantContext.js",
    "line": 29,
    "status": 401,
    "classification": "error",
    "snippet": "res.status(401).json({ success: false, message: 'Invalid token' })"
  },
  {
    "path": "src/middleware/planGuard.js",
    "line": 23,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json(buildDeniedPayload(plan, featureKey, upgradePath))"
  },
  {
    "path": "src/middleware/requireCompany.js",
    "line": 102,
    "status": 400,
    "classification": "error",
    "snippet": "res.status(400).json({ status: 'error', message: 'x-company-id header is required', code: 'COMPANY_CONTEXT_REQUIRED' })"
  },
  {
    "path": "src/middleware/requireCompany.js",
    "line": 119,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Company context is invalid', code: 'COMPANY_CONTEXT_INVALID' })"
  },
  {
    "path": "src/middleware/requireCompany.js",
    "line": 134,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Company context is invalid', code: 'COMPANY_CONTEXT_INVALID' })"
  },
  {
    "path": "src/middleware/requireCompany.js",
    "line": 152,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Company context is invalid', code: 'COMPANY_CONTEXT_INVALID' })"
  },
  {
    "path": "src/middleware/requireCompany.js",
    "line": 168,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Company context is invalid', code: 'COMPANY_CONTEXT_INVALID' })"
  },
  {
    "path": "src/middleware/requireCompany.js",
    "line": 181,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Company context is invalid', code: 'COMPANY_CONTEXT_INVALID' })"
  },
  {
    "path": "src/middleware/requireCompany.js",
    "line": 195,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Company context is invalid', code: 'COMPANY_CONTEXT_INVALID' })"
  },
  {
    "path": "src/middleware/requireCompany.js",
    "line": 210,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Company context is invalid', code: 'COMPANY_CONTEXT_INVALID' })"
  },
  {
    "path": "src/middleware/aiRateLimit.js",
    "line": 27,
    "status": 429,
    "classification": "error",
    "snippet": "res.status(429).json({ code: 'AI_RATE_LIMIT_EXCEEDED', message: 'AI insight rate limit exceeded. Try again later.' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 16,
    "status": 401,
    "classification": "error",
    "snippet": "res.status(401).json({ status: 'error', message: 'Authorization header must be in the format: Bearer <token>', code: 'AUTH_MISSING' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 24,
    "status": 401,
    "classification": "error",
    "snippet": "res.status(401).json({ status: 'error', message: 'Authentication credentials are missing', code: 'AUTH_MISSING' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 37,
    "status": 401,
    "classification": "error",
    "snippet": "res.status(401).json({ status: 'error', message: 'Token has been revoked', code: 'TOKEN_REVOKED' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 47,
    "status": 401,
    "classification": "error",
    "snippet": "res.status(401).json({ status: 'error', message: 'Invalid authentication token', code: 'TOKEN_INVALID' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 75,
    "status": 401,
    "classification": "error",
    "snippet": "res.status(401).json({ status: 'error', message: 'Token expired', code: 'TOKEN_INVALID' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 81,
    "status": 401,
    "classification": "error",
    "snippet": "res.status(401).json({ status: 'error', message: 'Invalid token', code: 'TOKEN_INVALID' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 96,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Insufficient permissions', code: 'INSUFFICIENT_ROLE' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 110,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'System admin access required', code: 'SYSTEM_ADMIN_REQUIRED' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 121,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'Insufficient permissions', code: 'INSUFFICIENT_ROLE' })"
  },
  {
    "path": "src/middleware/authMiddleware.js",
    "line": 128,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ status: 'error', message: 'System admin access required', code: 'SYSTEM_ADMIN_REQUIRED' })"
  },
  {
    "path": "src/middleware/security.js",
    "line": 11,
    "status": 415,
    "classification": "error",
    "snippet": "res.status(415).json({ success: false, message: `Unsupported Content-Type. Allowed: ${allowedTypes.join(', ')}` })"
  },
  {
    "path": "src/middleware/security.js",
    "line": 27,
    "status": 413,
    "classification": "error",
    "snippet": "res.status(413).json({ success: false, message: 'Request body too large' })"
  },
  {
    "path": "src/middleware/security.js",
    "line": 34,
    "status": 413,
    "classification": "error",
    "snippet": "res.status(413).json({ success: false, message: 'Request body too large' })"
  },
  {
    "path": "src/middleware/security.js",
    "line": 266,
    "status": 400,
    "classification": "error",
    "snippet": "res.status(400).json({ success: false, message: 'Validation failed', errors: errors.array() })"
  },
  {
    "path": "src/middleware/security.js",
    "line": 284,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ success: false, message: 'Access denied from your IP address' })"
  },
  {
    "path": "src/middleware/security.js",
    "line": 304,
    "status": 403,
    "classification": "error",
    "snippet": "res.status(403).json({ success: false, message: 'CSRF token validation failed' })"
  },
  {
    "path": "src/app.js",
    "line": 183,
    "status": 503,
    "classification": "error",
    "snippet": "res.status(dbStatus === 'connected' ? 200 : 503).json(payload)"
  },
  {
    "path": "src/app.js",
    "line": 203,
    "status": 503,
    "classification": "error",
    "snippet": "res.status(503).json({ status: 'not-ready', environment: process.env.NODE_ENV || 'development' })"
  },
  {
    "path": "src/app.js",
    "line": 310,
    "status": 404,
    "classification": "error",
    "snippet": "res.status(404).json({ status: 'error', message: 'Route not found', path: req.originalUrl })"
  }
]
